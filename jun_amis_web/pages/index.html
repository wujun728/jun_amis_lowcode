<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>jqp低代码管理系统</title>
<link rel="icon" href="images/logo.png" type="image/png">
<meta name="keywords" content="低代码管理系统">
<meta name="description" content="低代码管理系统">
<meta name="author" content="yinqi">
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/materialdesignicons.min.css" rel="stylesheet">
<link rel="stylesheet" href="js/bootstrap-multitabs/multitabs.min.css">
<link href="css/style.min.css" rel="stylesheet">
<style>
  .topbar-left .navbar-nav {
    margin: 0px;
  }
  .topbar-left .navbar-nav a {
    padding-top: 10px;
    padding-bottom: 10px;
    line-height: 20px;
  }
  .topbar-left .navbar-nav a i {
    display: none;
  }
  .topbar-left .navbar-nav li {
    float: left;
  }
  li.active a{
      background-color:white !important;
      color:#33cabb !important;
  }
  @media screen and (max-width: 980px) {
    .header-icon-menu {
      display: block;
      height: 68px;
      line-height: 68px;
      font-size: 1.5em;
      cursor: pointer;
      padding: 0 12px;
      text-align: center;
    }
    .topbar-left .icon-menu-ul li {
      float: none;
    }
  }
  @media (min-width: 980px) {
    .header-icon-menu {
      display: none;
    }
    .topbar-left .navbar-nav.dropdown-menu {
      display: block;
      position: inherit;
      box-shadow: none;
      background-color: transparent;
    }
   [data-headerbg*='color_'] .topbar-left .navbar-nav a {
      color: rgba(255, 255, 255, .75);
    }
    [data-headerbg*='color_'] .topbar-left .navbar-nav a:focus,
    [data-headerbg*='color_'] .topbar-left .navbar-nav a:hover {
      color: #fff;
    }
    [data-headerbg*='color_'] .topbar-left .navbar-nav>.active>a,
    [data-headerbg*='color_'] .topbar-left .navbar-nav>.active>a:focus,
    [data-headerbg*='color_'] .topbar-left .navbar-nav>.active>a:hover {
      background-color: rgba(255,255,255,.125);
      color: #fff;
    }
  }
</style>
<script>
    // if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
    //     //该页面是在移动端打开的，
    //     window.location.href="/admin/mobile.html?t="+new Date().getTime();
    // }
</script>
</head>

<body >
<div class="lyear-layout-web">
  <div class="lyear-layout-container">
    <!--左侧导航-->
    <aside class="lyear-layout-sidebar">

      <!-- logo -->
      <div id="logo" class="sidebar-header">
        <a href="index.html"><img src="images/logo.png" style="height:40px;" /><span style="font-size:1.2em;line-height:40px;">低代码管理系统</span></a>
      </div>
      <div class="lyear-layout-sidebar-scroll">

        <nav class="sidebar-main" id="menus">
          <!--
          <ul class="nav nav-drawer" >
              <li class="nav-item active"> <a class="multitabs" href="lyear_main.html"><i class="mdi mdi-home"></i> <span>首页</span></a> </li>
          </ul>
          -->
        </nav>
      </div>

    </aside>
    <!--End 左侧导航-->

    <!--头部信息-->
    <header class="lyear-layout-header">

      <nav class="navbar navbar-default">
        <div class="topbar">

          <div class="topbar-left">
            <div class="lyear-aside-toggler">
              <span class="lyear-toggler-bar"></span>
              <span class="lyear-toggler-bar"></span>
              <span class="lyear-toggler-bar"></span>
            </div>
            <div class="dropdown">
              <span class="header-icon-menu" data-toggle="dropdown"><i class="mdi mdi-apps"></i></span>
              <ul class="nav navbar-nav dropdown-menu icon-menu-ul" id="topNav">
              </ul>
            </div>
          </div>

          <ul class="topbar-right">
            <li class="dropdown dropdown-profile">
              <a href="javascript:void(0)" data-toggle="dropdown">
                  <!--
                <img id="userAvatar" class="img-avatar img-avatar-48 m-r-10" src="images/users/avatar.jpg" />
                -->
                <span><span id="userName">****</span><span class="caret"></span></span>
              </a>
              <ul class="dropdown-menu dropdown-menu-right">
                  <!--
                <li> <a class="multitabs" data-url="lyear_pages_profile.html" href="javascript:void(0)"><i class="mdi mdi-account"></i> 个人信息</a> </li>
                -->
                <li> <a class="multitabs" data-url="lyear_pages_edit_pwd.html" href="javascript:void(0)"><i class="mdi mdi-lock-outline"></i> 修改密码</a> </li>
                  <!--
                    <li> <a href="javascript:void(0)"><i class="mdi mdi-delete"></i> 清空缓存</a></li>
                    -->
                  <li class="divider"></li>
                  <li> <a href="/pages/login.html"><i class="mdi mdi-logout-variant"></i> 退出登录</a> </li>
                  <!-- <li> <a href="/admin/user/logout"><i class="mdi mdi-logout-variant"></i> 退出登录</a> </li> -->
                </ul>
              </li>
              <!--切换主题配色-->
              <!--
		    <li class="dropdown dropdown-skin">
			  <span data-toggle="dropdown" class="icon-palette"><i class="mdi mdi-palette"></i></span>
			  <ul class="dropdown-menu dropdown-menu-right" data-stopPropagation="true">
			    <li class="drop-title"><p>LOGO</p></li>
				<li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="logo_bg" value="default" id="logo_bg_1" checked>
                    <label for="logo_bg_1"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_2" id="logo_bg_2">
                    <label for="logo_bg_2"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_3" id="logo_bg_3">
                    <label for="logo_bg_3"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_4" id="logo_bg_4">
                    <label for="logo_bg_4"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_5" id="logo_bg_5">
                    <label for="logo_bg_5"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_6" id="logo_bg_6">
                    <label for="logo_bg_6"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_7" id="logo_bg_7">
                    <label for="logo_bg_7"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_8" id="logo_bg_8">
                    <label for="logo_bg_8"></label>
                  </span>
				</li>
				<li class="drop-title"><p>头部</p></li>
				<li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="header_bg" value="default" id="header_bg_1" checked>
                    <label for="header_bg_1"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_2" id="header_bg_2">
                    <label for="header_bg_2"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_3" id="header_bg_3">
                    <label for="header_bg_3"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_4" id="header_bg_4">
                    <label for="header_bg_4"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_5" id="header_bg_5">
                    <label for="header_bg_5"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_6" id="header_bg_6">
                    <label for="header_bg_6"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_7" id="header_bg_7">
                    <label for="header_bg_7"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_8" id="header_bg_8">
                    <label for="header_bg_8"></label>
                  </span>
				</li>
				<li class="drop-title"><p>侧边栏</p></li>
				<li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="sidebar_bg" value="default" id="sidebar_bg_1" checked>
                    <label for="sidebar_bg_1"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_2" id="sidebar_bg_2">
                    <label for="sidebar_bg_2"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_3" id="sidebar_bg_3">
                    <label for="sidebar_bg_3"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_4" id="sidebar_bg_4">
                    <label for="sidebar_bg_4"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_5" id="sidebar_bg_5">
                    <label for="sidebar_bg_5"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_6" id="sidebar_bg_6">
                    <label for="sidebar_bg_6"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_7" id="sidebar_bg_7">
                    <label for="sidebar_bg_7"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_8" id="sidebar_bg_8">
                    <label for="sidebar_bg_8"></label>
                  </span>
				</li>
			  </ul>
			</li>
              -->
            <!--切换主题配色-->
          </ul>

        </div>
      </nav>

    </header>
    <!--End 头部信息-->

    <!--页面主要内容-->
    <main class="lyear-layout-content">

      <div id="iframe-content"></div>

    </main>
    <!--End 页面主要内容-->
  </div>
</div>

<script type="text/javascript" src="js/jquery.min.js"></script>

<script type="text/javascript">

    function buildMenu(ul,menus){
        for (let i = 0; i < menus.length; i++) {
            let menu = menus[i];
            let icon = "";
            if(menu.icon && menu.icon != ""){
                icon = '<i class="mdi '+menu.icon+'"></i>';
            }
            if(menu.children && menu.children.length>0 ){
                let li = '<li class="nav-item nav-item-has-subnav">';
                li += '<a href="javascript:void(0)">'+icon+' <span>'+menu.menuName+'</span></a>'
                li += '</li>';
                li = $(li);
                let childUl = $('<ul class="nav nav-subnav"></ul>');
                li.append(childUl);
                ul.append(li);
                buildMenu(childUl,menu.children);
            }else{
                menu.url//+ "&amisDebug=1"; //amisDebug模式
                //menu.url += "?v="+new Date().getTime() //+ "&amisDebug=1"; //amisDebug模式
                ul.append('<li class="nav-item"> <a class="multitabs" href="'+menu.url+'">'+icon+'<span>'+menu.menuName+'</span></a> </li>');
            }
        }
    }

    $.ajax({
        method:"post",
        url:"/admin/user/getUserSession",
        dataType:"JSON",
        success:function(resp){
            let data = resp.data;
            $("#userName").text(data.name);
            if(data.avatar){
                $("#userAvatar").attr("src",data.avatar);
            }
            var topUl = $("#topNav");
            for(let i=0;i<data.menus.length;i++){
              let menu = data.menus[i];
              let iconCls = "";
              if(menu.icon && menu.icon != ""){
                  iconCls = 'mdi '+menu.icon;
              }
              let cls = i==0?"class='active'":"";

              topUl.append('<li '+cls+'><a href="javascript:void(0)" onclick="showMenus(this, \''+menu.id+'\')">'+'<span  class="'+iconCls+'">'+menu.menuName+'</span></a></li>');

              let leftUl = $('<ul class="nav nav-drawer '+(i!=0?'collapse':'')+'" id="menus-'+menu.id+'" ></ul>');

              if(menu.children && menu.children.length>0 ){
                // let li = '<li class="nav-item nav-item-has-subnav">';
                // li += '<a href="javascript:void(0)">'+icon+' <span>'+menu.menuName+'</span></a>'
                // li += '</li>';
                // li = $(li);
                // let childUl = $('<ul class="nav nav-subnav"></ul>');
                // li.append(childUl);
                // leftUl.append(li);
                buildMenu(leftUl,menu.children);
              }else{
                //menu.url += "?v="+new Date().getTime() //+ "&amisDebug=1"; //amisDebug模式
                menu.url  //+ "&amisDebug=1"; //amisDebug模式
                leftUl.append('<li class="nav-item"> <a class="multitabs" href="'+menu.url+'">'+'<span class="'+iconCls+'">'+menu.menuName+'</span></a> </li>');
              }

              $("#menus").append(leftUl);
            }
        }
    });

    function showMenus(obj, id)
    {
      $('.sidebar-main .nav-drawer').slideUp('slow');
      $('#menus-'+id).slideDown('slow');
      $(obj).parent('li').addClass('active').siblings().removeClass('active');
      $('.lyear-layout-sidebar-scroll').animate({scrollTop: 0}, 300);  // 处理滚动条到最上方
    }
</script>

<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/perfect-scrollbar.min.js"></script>
<script type="text/javascript" src="js/bootstrap-multitabs/multitabs.js"></script>
<script type="text/javascript" src="js/index.min.js"></script>
</body>
</html>
